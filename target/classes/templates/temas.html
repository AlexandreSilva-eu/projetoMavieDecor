<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Temas de Festas - Mavie Decor</title>
    <link rel="stylesheet" th:href="@{/css/mavie.css}">
</head>
<body>
<header>
    <img th:src="@{/img/logo-mavie.jpeg}" alt="Mavie Decor Logo">
</header>

<div class="container">
    <h1>Temas de Festas</h1>

    <!-- Barra de filtro -->
    <div class="filter-bar">
        <button id="openFilter" class="filter-button">Filtrar ▾</button>
    </div>

    <!-- Painel de filtro -->
    <div id="filterPanel" class="filter-panel" role="dialog" aria-hidden="true">
        <form id="filterForm" th:action="@{/temas}" method="get">
            <div><strong>Escolha a categoria</strong></div>

            <div th:each="cat : ${categorias}" class="filter-option">
                <label>
                    <input type="radio" name="categoria"
                           th:value="${cat.name()}"
                           th:checked="${cat.name() == categoriaSelecionada}" />
                    <span th:text="${cat}">Categoria</span>
                </label>
            </div>

            <div class="filter-actions">
                <button type="button" id="clearFilter" class="btn secondary">Limpar</button>
                <button type="submit" class="btn">Aplicar</button>
            </div>
        </form>
    </div>

    <!-- Grid de temas -->
    <div th:if="${#lists.isEmpty(temas) == false}" class="grid">
        <div class="card" th:each="t : ${temas}">
            <img th:src="@{${t.thumbnailPath}}" th:alt="${t.nomeTema}" class="thumb">
            <h2 th:text="${t.nomeTema}">Nome do Tema</h2>
            <ul>
                <li th:each="cat : ${t.categorias}" th:text="${cat}">Categoria</li>
            </ul>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(temas)}">
        <p class="no-results">Nenhum tema encontrado para esta categoria.</p>
    </div>

    <div style="margin-top:12px;">
        <a class="btn" th:href="@{/homepage}">Ir para homepage</a>
    </div>
</div>

<script>
    // Toggle painel de filtro
    const openBtn = document.getElementById('openFilter');
    const panel = document.getElementById('filterPanel');
    const clearBtn = document.getElementById('clearFilter');

    openBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        panel.classList.toggle('active');
        panel.setAttribute('aria-hidden', panel.classList.contains('active') ? 'false' : 'true');
    });

    // Limpar filtro: remove seleção e submete o formulário
    clearBtn.addEventListener('click', () => {
        const form = document.getElementById('filterForm');
        const checked = form.querySelector('input[name="categoria"]:checked');
        if (checked) checked.checked = false;
        form.submit();
    });

    // Fecha painel ao clicar fora
    document.addEventListener('click', (e) => {
        if (!panel.contains(e.target) && !openBtn.contains(e.target)) {
            panel.classList.remove('active');
            panel.setAttribute('aria-hidden','true');
        }
    });
</script>
</body>
</html>
